dist: bionic
language: go
os: linux

go:
  - 1.15.x
  - tip

env:
  global:
    # REVIEWDOG_GITHUB_API_TOKEN
    secure: EaQ5dC5pg6donGFAROkzIgETFi5SV9GFaL1wCnL6Etj2NR/ggqdqjdJOkd9rtBAYUPRB968Arfun21yl1bknVB9lLz97zZuUSSfBBqXzm3npI3GunAkaJVCgZ8Q72w9WfQySp18+TdeDAA7HjlzinbVs9Lt9c1qIzbnOTYLH35ChdZuj1pztUx07SclCrQ55hw6lqQhG6GYhGFlTwUOl8zgJBBND4QjOJ8iZ0L3t2bqzpUKLtAB3JGxGku6OFyLkGJhA1Hr/+BkODsYeZeHWwBXJ5HceiduyU+Z/xcwBmaUSqzoaTVT0DfH6oP4n1VHj6wFJWSAc50P12I9Mi1JzKXUdBMlvIBmBZ9jt3PWqPcLpjCGOWklUuNDMDE94rmJ3RkC9uqQWRm+G8ivPQ3UjeswOT4xFDNBGjWppyc2TNOaVWxs/lDfF2Qt4ElgyjZHa0q3IE5sdz6KF+cDUbfoSak3bLkch9RQXATq+ywS/ztmlXnN/79RULXWRjITDFcf/UIbpEsJ19tac6lQ4/TYPXMdorZP4OMp7tDfmHC4C91rOqfq+eJOnQ3Q+2W4WdPcybF1SeFyzuTqDRAhJkviwlGkS4M3hD9ypAzThfiT88uF0Uu7lX2ZSQkj9OsfBZH0L5OmBdj12BmfjVQFiBRK5H6EKAymj09KO/8zeJz0CUq4=

jobs:
  fast_finish: true
  allow_failures:
    - go: tip

# skip non-trunk PMM-XXXX branch builds, but still build pull requests
branches:
  except:
    - /^PMM\-\d{4}/

go_import_path: github.com/Percona-Lab/pmm-api-tests

before_cache:
  - go clean -testcache

cache:
  directories:
    - /home/travis/.cache/go-build
    - /home/travis/gopath/pkg

install: skip

before_script:
  - make init
  # static analyze
  - make ci-reviewdog

script:
  - make build

notifications:
  slack:
    on_success: change
    on_failure: always
    rooms:
      secure: nvqu/KY2K0yNZv9WzqPP49RmkQzvscteV9AsECgIWXZziQhHkyn/yWCAeYPP6nnn76wzQkXfDLGQedGB3ceVebzWdrbcqG091x5FFIGz5YU4mSaWZHKfmS7CWbImDr+1vMJGDFfDBspYahx50PhtwURBA4WUw2C1wfiIMs79+JhxVbcYJqxDHLaaCddAf58TPtNGLibXLKkX0MLXsXfxp1ipheweT7n3jugzKNMgckxYzxrZwlq7ZZOA4IxuwrBkHBDaxrukWAgT+qB9Y6HEJRI6jDuDcaIBfpafhh+4kFyawMm7iODfpe1Gl0WeIqogGNp2rOZ8vynG9RSRtMC7A1o/I0CQQskrSHn78GPTb0eLODNn9iElEfHg5xolb9Cju/qUGDE2/psTWtjWkwSpxpySMlkCnc+AYm6eSunB5cxBkjXA1Q5AA5YP4j9ewHcYkbAcabY7DPPZCinGEb9xwm2F/5xscguYi6DGY/NeNH5QeJxSXIAYYFaY6AuQslXaRzc4CSH94mJGQ/dWO12B3OJnoprTYUTPZNrHICSC8eeKBtzzE+Y+OeA3hr1LcxbtfxkTY3o2eyFmVc0zgcXNeXlbNxHsQtEpdt+7GUHYAj/H1b/tOZE2LShFRQo1MrTbubggcvlbCq/oTerbXC0WJjJQOY5t7jTRXChAhvTiHNE=
